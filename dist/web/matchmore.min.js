!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).matchmore=f()}}(function(){return function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}}()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.Client=class{constructor(baseUrl,transformOptions,http){this.jsonParseReviver=void 0,this.http=http||window,this.transformOptions=transformOptions,this.baseUrl=baseUrl||"https://api.matchmore.io/v5"}createDevice(device){let url_=this.baseUrl+"/devices";url_=url_.replace(/[?&]$/,"");let options_={body:JSON.stringify(device),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processCreateDevice(_response))}processCreateDevice(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),201===status||200===status?response.text().then(_responseText=>{let result201=null,resultData201=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result201=resultData201?Device.fromJS(resultData201):new Device}):403===status?response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers)):response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers,null))}getIBeaconTriples(){let url_=this.baseUrl+"/devices/IBeaconTriples";return url_=url_.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetIBeaconTriples(_response))}processGetIBeaconTriples(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);if(resultData200&&resultData200.constructor===Array){result200=[];for(let item of resultData200)result200.push(IBeaconTriple.fromJS(item))}return result200}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getDevice(deviceId){let url_=this.baseUrl+"/devices/{deviceId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");return url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetDevice(_response))}processGetDevice(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result200=resultData200?Device.fromJS(resultData200):new Device}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}deleteDevice(deviceId){let url_=this.baseUrl+"/devices/{deviceId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");return url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,""),this.transformOptions({method:"DELETE",headers:{"Content-Type":"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processDeleteDevice(_response))}processDeleteDevice(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}updateDevice(deviceId,device){let url_=this.baseUrl+"/devices/{deviceId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,"");let options_={body:JSON.stringify(device),method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processUpdateDevice(_response))}processUpdateDevice(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result200=resultData200?Device.fromJS(resultData200):new Device}):403===status?response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers)):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getMatches(deviceId){let url_=this.baseUrl+"/devices/{deviceId}/matches";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");return url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetMatches(_response))}processGetMatches(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);if(resultData200&&resultData200.constructor===Array){result200=[];for(let item of resultData200)result200.push(Match.fromJS(item))}return result200}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getMatch(deviceId,matchId){let url_=this.baseUrl+"/devices/{deviceId}/matches/{matchId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");if(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId)),void 0===matchId||null===matchId)throw new Error("The parameter 'matchId' must be defined.");return url_=(url_=url_.replace("{matchId}",encodeURIComponent(""+matchId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetMatch(_response))}processGetMatch(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result200=resultData200?Match.fromJS(resultData200):new Match}):404===status?response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers,null)):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}createPublication(deviceId,publication){let url_=this.baseUrl+"/devices/{deviceId}/publications";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,"");let options_={body:JSON.stringify(publication),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processCreatePublication(_response))}processCreatePublication(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),201===status?response.text().then(_responseText=>{let result201=null,resultData201=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result201=resultData201?Publication.fromJS(resultData201):new Publication}):403===status?response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers)):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getPublications(deviceId){let url_=this.baseUrl+"/devices/{deviceId}/publications";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");return url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetPublications(_response))}processGetPublications(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);if(resultData200&&resultData200.constructor===Array){result200=[];for(let item of resultData200)result200.push(Publication.fromJS(item))}return result200}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getPublication(deviceId,publicationId){let url_=this.baseUrl+"/devices/{deviceId}/publications/{publicationId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");if(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId)),void 0===publicationId||null===publicationId)throw new Error("The parameter 'publicationId' must be defined.");return url_=(url_=url_.replace("{publicationId}",encodeURIComponent(""+publicationId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetPublication(_response))}processGetPublication(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result200=resultData200?Publication.fromJS(resultData200):new Publication}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}deletePublication(deviceId,publicationId){let url_=this.baseUrl+"/devices/{deviceId}/publications/{publicationId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");if(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId)),void 0===publicationId||null===publicationId)throw new Error("The parameter 'publicationId' must be defined.");return url_=(url_=url_.replace("{publicationId}",encodeURIComponent(""+publicationId))).replace(/[?&]$/,""),this.transformOptions({method:"DELETE",headers:{"Content-Type":"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processDeletePublication(_response))}processDeletePublication(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}createSubscription(deviceId,subscription){let url_=this.baseUrl+"/devices/{deviceId}/subscriptions";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,"");let options_={body:JSON.stringify(subscription),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processCreateSubscription(_response))}processCreateSubscription(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),201===status?response.text().then(_responseText=>{let result201=null,resultData201=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result201=resultData201?Subscription.fromJS(resultData201):new Subscription}):403===status?response.text().then(_responseText=>throwException("A server error occurred.",status,_responseText,_headers)):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getSubscriptions(deviceId){let url_=this.baseUrl+"/devices/{deviceId}/subscriptions";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");return url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetSubscriptions(_response))}processGetSubscriptions(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);if(resultData200&&resultData200.constructor===Array){result200=[];for(let item of resultData200)result200.push(Subscription.fromJS(item))}return result200}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}getSubscription(deviceId,subscriptionId){let url_=this.baseUrl+"/devices/{deviceId}/subscriptions/{subscriptionId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");if(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId)),void 0===subscriptionId||null===subscriptionId)throw new Error("The parameter 'subscriptionId' must be defined.");return url_=(url_=url_.replace("{subscriptionId}",encodeURIComponent(""+subscriptionId))).replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processGetSubscription(_response))}processGetSubscription(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{let result200=null,resultData200=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result200=resultData200?Subscription.fromJS(resultData200):new Subscription}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}deleteSubscription(deviceId,subscriptionId){let url_=this.baseUrl+"/devices/{deviceId}/subscriptions/{subscriptionId}";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");if(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId)),void 0===subscriptionId||null===subscriptionId)throw new Error("The parameter 'subscriptionId' must be defined.");return url_=(url_=url_.replace("{subscriptionId}",encodeURIComponent(""+subscriptionId))).replace(/[?&]$/,""),this.transformOptions({method:"DELETE",headers:{"Content-Type":"application/json"}}).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processDeleteSubscription(_response))}processDeleteSubscription(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),200===status?response.text().then(_responseText=>{}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}createLocation(deviceId,location){let url_=this.baseUrl+"/devices/{deviceId}/locations";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,"");let options_={body:JSON.stringify(location),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processCreateLocation(_response))}processCreateLocation(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),201===status?response.text().then(_responseText=>{let result201=null,resultData201=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result201=resultData201?Location.fromJS(resultData201):new Location}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}triggerProximityEvents(deviceId,proximityEvent){let url_=this.baseUrl+"/devices/{deviceId}/proximityEvents";if(void 0===deviceId||null===deviceId)throw new Error("The parameter 'deviceId' must be defined.");url_=(url_=url_.replace("{deviceId}",encodeURIComponent(""+deviceId))).replace(/[?&]$/,"");let options_={body:JSON.stringify(proximityEvent),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(options_).then(transformedOptions_=>this.http.fetch(url_,transformedOptions_)).then(_response=>this.processTriggerProximityEvents(_response))}processTriggerProximityEvents(response){const status=response.status;let _headers={};return response.headers&&response.headers.forEach&&response.headers.forEach((v,k)=>_headers[k]=v),201===status?response.text().then(_responseText=>{let result201=null,resultData201=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result201=resultData201?ProximityEvent.fromJS(resultData201):new ProximityEvent}):response.text().then(_responseText=>{let result=null,resultData=""===_responseText?null:JSON.parse(_responseText,this.jsonParseReviver);return result=resultData?APIError.fromJS(resultData):null,throwException("A server error occurred.",status,_responseText,_headers,result)})}},function(DeviceType){DeviceType[DeviceType.MobileDevice="MobileDevice"]="MobileDevice",DeviceType[DeviceType.PinDevice="PinDevice"]="PinDevice",DeviceType[DeviceType.IBeaconDevice="IBeaconDevice"]="IBeaconDevice"}(exports.DeviceType||(exports.DeviceType={}));class Device{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property]);data||(this.name=""),this._discriminator="Device"}init(data){if(data){if(this.id=data.id,this.createdAt=data.createdAt,this.updatedAt=data.updatedAt,data.group&&data.group.constructor===Array){this.group=[];for(let item of data.group)this.group.push(item)}this.name=void 0!==data.name?data.name:""}}static fromJS(data){if("MobileDevice"===(data="object"==typeof data?data:{}).deviceType){let result=new MobileDevice;return result.init(data),result}if("PinDevice"===data.deviceType){let result=new PinDevice;return result.init(data),result}if("IBeaconDevice"===data.deviceType){let result=new IBeaconDevice;return result.init(data),result}let result=new Device;return result.init(data),result}toJSON(data){if((data="object"==typeof data?data:{}).deviceType=this._discriminator,data.id=this.id,data.createdAt=this.createdAt,data.updatedAt=this.updatedAt,this.group&&this.group.constructor===Array){data.group=[];for(let item of this.group)data.group.push(item)}return data.name=this.name,data}}exports.Device=Device;class DeviceUpdate{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property])}init(data){data&&(this.name=data.name,this.deviceToken=data.deviceToken)}static fromJS(data){data="object"==typeof data?data:{};let result=new DeviceUpdate;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).name=this.name,data.deviceToken=this.deviceToken,data}}exports.DeviceUpdate=DeviceUpdate;class IBeaconTriple{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property])}init(data){data&&(this.deviceId=data.deviceId,this.proximityUUID=data.proximityUUID,this.major=data.major,this.minor=data.minor)}static fromJS(data){data="object"==typeof data?data:{};let result=new IBeaconTriple;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).deviceId=this.deviceId,data.proximityUUID=this.proximityUUID,data.major=this.major,data.minor=this.minor,data}}exports.IBeaconTriple=IBeaconTriple;class Location{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property]);data||(this.latitude=0,this.longitude=0,this.altitude=0,this.horizontalAccuracy=1,this.verticalAccuracy=1)}init(data){data&&(this.createdAt=data.createdAt,this.latitude=void 0!==data.latitude?data.latitude:0,this.longitude=void 0!==data.longitude?data.longitude:0,this.altitude=void 0!==data.altitude?data.altitude:0,this.horizontalAccuracy=void 0!==data.horizontalAccuracy?data.horizontalAccuracy:1,this.verticalAccuracy=void 0!==data.verticalAccuracy?data.verticalAccuracy:1)}static fromJS(data){data="object"==typeof data?data:{};let result=new Location;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).createdAt=this.createdAt,data.latitude=this.latitude,data.longitude=this.longitude,data.altitude=this.altitude,data.horizontalAccuracy=this.horizontalAccuracy,data.verticalAccuracy=this.verticalAccuracy,data}}exports.Location=Location;class Publication{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property]);data||(this.properties={})}init(data){if(data&&(this.id=data.id,this.createdAt=data.createdAt,this.worldId=data.worldId,this.deviceId=data.deviceId,this.topic=data.topic,this.location=data.location?Location.fromJS(data.location):void 0,this.range=data.range,this.duration=data.duration,data.properties)){this.properties={};for(let key in data.properties)data.properties.hasOwnProperty(key)&&(this.properties[key]=data.properties[key]?data.properties[key]:void 0)}}static fromJS(data){data="object"==typeof data?data:{};let result=new Publication;return result.init(data),result}toJSON(data){if((data="object"==typeof data?data:{}).id=this.id,data.createdAt=this.createdAt,data.worldId=this.worldId,data.deviceId=this.deviceId,data.topic=this.topic,data.location=this.location?this.location.toJSON():void 0,data.range=this.range,data.duration=this.duration,this.properties){data.properties={};for(let key in this.properties)this.properties.hasOwnProperty(key)&&(data.properties[key]=this.properties[key])}return data}}exports.Publication=Publication;class Subscription{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property])}init(data){if(data&&(this.id=data.id,this.createdAt=data.createdAt,this.worldId=data.worldId,this.deviceId=data.deviceId,this.topic=data.topic,this.location=data.location?Location.fromJS(data.location):void 0,this.selector=data.selector,this.range=data.range,this.duration=data.duration,this.matchTTL=data.matchTTL,data.pushers&&data.pushers.constructor===Array)){this.pushers=[];for(let item of data.pushers)this.pushers.push(item)}}static fromJS(data){data="object"==typeof data?data:{};let result=new Subscription;return result.init(data),result}toJSON(data){if((data="object"==typeof data?data:{}).id=this.id,data.createdAt=this.createdAt,data.worldId=this.worldId,data.deviceId=this.deviceId,data.topic=this.topic,data.location=this.location?this.location.toJSON():void 0,data.selector=this.selector,data.range=this.range,data.duration=this.duration,data.matchTTL=this.matchTTL,this.pushers&&this.pushers.constructor===Array){data.pushers=[];for(let item of this.pushers)data.pushers.push(item)}return data}}exports.Subscription=Subscription;class Match{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property]);data||(this.publication=new Publication,this.subscription=new Subscription)}init(data){data&&(this.id=data.id,this.createdAt=data.createdAt,this.publication=data.publication?Publication.fromJS(data.publication):new Publication,this.subscription=data.subscription?Subscription.fromJS(data.subscription):new Subscription)}static fromJS(data){data="object"==typeof data?data:{};let result=new Match;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).id=this.id,data.createdAt=this.createdAt,data.publication=this.publication?this.publication.toJSON():void 0,data.subscription=this.subscription?this.subscription.toJSON():void 0,data}}exports.Match=Match;class APIError{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property])}init(data){data&&(this.code=data.code,this.message=data.message)}static fromJS(data){data="object"==typeof data?data:{};let result=new APIError;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).code=this.code,data.message=this.message,data}}exports.APIError=APIError;class MobileDevice extends Device{constructor(data){super(data),data||(this.location=new Location),this._discriminator="MobileDevice"}init(data){super.init(data),data&&(this.platform=data.platform,this.deviceToken=data.deviceToken,this.location=data.location?Location.fromJS(data.location):new Location)}static fromJS(data){data="object"==typeof data?data:{};let result=new MobileDevice;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).platform=this.platform,data.deviceToken=this.deviceToken,data.location=this.location?this.location.toJSON():void 0,super.toJSON(data),data}}exports.MobileDevice=MobileDevice;class PinDevice extends Device{constructor(data){super(data),data||(this.location=new Location),this._discriminator="PinDevice"}init(data){super.init(data),data&&(this.location=data.location?Location.fromJS(data.location):new Location)}static fromJS(data){data="object"==typeof data?data:{};let result=new PinDevice;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).location=this.location?this.location.toJSON():void 0,super.toJSON(data),data}}exports.PinDevice=PinDevice;class IBeaconDevice extends Device{constructor(data){super(data),this._discriminator="IBeaconDevice"}init(data){super.init(data),data&&(this.proximityUUID=data.proximityUUID,this.major=data.major,this.minor=data.minor)}static fromJS(data){data="object"==typeof data?data:{};let result=new IBeaconDevice;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).proximityUUID=this.proximityUUID,data.major=this.major,data.minor=this.minor,super.toJSON(data),data}}exports.IBeaconDevice=IBeaconDevice;class ProximityEvent{constructor(data){if(data)for(var property in data)data.hasOwnProperty(property)&&(this[property]=data[property])}init(data){data&&(this.id=data.id,this.createdAt=data.createdAt,this.deviceId=data.deviceId,this.distance=data.distance)}static fromJS(data){data="object"==typeof data?data:{};let result=new ProximityEvent;return result.init(data),result}toJSON(data){return(data="object"==typeof data?data:{}).id=this.id,data.createdAt=this.createdAt,data.deviceId=this.deviceId,data.distance=this.distance,data}}exports.ProximityEvent=ProximityEvent;class SwaggerException extends Error{constructor(message,status,response,headers,result){super(),this.isSwaggerException=!0,this.message=message,this.status=status,this.response=response,this.headers=headers,this.result=result}static isSwaggerException(obj){return!0===obj.isSwaggerException}}function throwException(message,status,response,headers,result){throw null!==result&&void 0!==result?result:new SwaggerException(message,status,response,headers,null)}exports.SwaggerException=SwaggerException},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const manager_1=require("./manager");exports.Manager=manager_1.Manager;const client_1=require("./client");exports.Client=client_1.Client;const InMemoryPersistenceManager_1=require("./persistences/InMemoryPersistenceManager");exports.InMemoryPersistenceManager=InMemoryPersistenceManager_1.default;const LocalStoragePersistenceManager_1=require("./persistences/LocalStoragePersistenceManager");exports.LocalStoragePersistenceManager=LocalStoragePersistenceManager_1.default;const platform_1=require("./platform");exports.PlatformConfig=platform_1.default;const matchmonitor_1=require("./matchmonitor");exports.MatchMonitorMode=matchmonitor_1.MatchMonitorMode},{"./client":1,"./manager":4,"./matchmonitor":5,"./persistences/InMemoryPersistenceManager":7,"./persistences/LocalStoragePersistenceManager":8,"./platform":9}],3:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const client_1=require("./client");exports.LocationManager=class{constructor(manager,config){this.manager=manager,this._defaultConfig={enableHighAccuracy:!1,timeout:6e4,maximumAge:6e4},this.onLocationReceived=(loc=>__awaiter(this,void 0,void 0,function*(){const location=new client_1.Location({latitude:loc.coords.latitude,longitude:loc.coords.longitude,altitude:loc.coords.altitude||0,horizontalAccuracy:loc.coords.accuracy,verticalAccuracy:loc.coords.accuracy});yield this.manager.updateLocation(location),this._onLocationUpdate&&this._onLocationUpdate(location)})),this._gpsConfig=config||this._defaultConfig,this._onLocationUpdate=(_=>{})}startUpdatingLocation(){if(!navigator.geolocation)throw new Error("Geolocation is not supported in this browser/app");navigator.geolocation.getCurrentPosition(this.onLocationReceived,this.onError,this._gpsConfig),this._geoId=navigator.geolocation.watchPosition(this.onLocationReceived,this.onError,this._gpsConfig)}stopUpdatingLocation(){if(!navigator.geolocation)throw new Error("Geolocation is not supported in this browser/app");navigator.geolocation.clearWatch(this._geoId)}set onLocationUpdate(onLocationUpdate){this._onLocationUpdate=onLocationUpdate}onError(error){throw new Error(error.message)}}},{"./client":1}],4:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const client_1=require("./client"),Base64=require("Base64"),matchmonitor_1=require("./matchmonitor"),locationmanager_1=require("./locationmanager"),index_1=require("./index");exports.Manager=class{constructor(apiKey,apiUrlOverride,persistenceManager,gpsConfig){if(this.apiKey=apiKey,this.apiUrlOverride=apiUrlOverride,!apiKey)throw new Error("Api key required");this._persistenceManager=persistenceManager||new index_1.InMemoryPersistenceManager,this.token=JSON.parse(Base64.atob(this.apiKey.split(".")[1]));var basePath="https://api.matchmore.io/v5";this.apiUrlOverride?basePath=this.apiUrlOverride:this.apiUrlOverride=basePath,this.api=new client_1.Client(basePath,options=>(options.headers["api-key"]=this.apiKey,Promise.resolve(options)),{fetch:fetch}),this._matchMonitor=new matchmonitor_1.MatchMonitor(this),this._locationManager=new locationmanager_1.LocationManager(this,gpsConfig)}load(){return __awaiter(this,void 0,void 0,function*(){return yield this._persistenceManager.load()})}get apiUrl(){return this.apiUrlOverride}get defaultDevice(){return this._persistenceManager.defaultDevice()}get devices(){return this._persistenceManager.devices()}get publications(){return this._persistenceManager.publications()}get subscriptions(){return this._persistenceManager.subscriptions()}createMobileDevice(name,platform,deviceToken){return this.createAnyDevice(new client_1.MobileDevice({name:name,platform:platform,deviceToken:deviceToken,location:new client_1.Location({latitude:0,longitude:0,altitude:0})}))}createPinDevice(name,location){return this.createAnyDevice(new client_1.PinDevice({name:name,location:this.resolveLocationType(location)}))}createIBeaconDevice(name,proximityUUID,major,minor){return this.createAnyDevice(new client_1.IBeaconDevice({name:name,proximityUUID:proximityUUID,major:major,minor:minor}))}createAnyDevice(device){return __awaiter(this,void 0,void 0,function*(){try{const result=yield this.api.createDevice(device),isDefault=!this._persistenceManager.defaultDevice();return this._persistenceManager.addDevice(result,isDefault),result}catch(error){this.handleError(error,`create device '${device.name}'`)}})}handleError(error,operation){if(error instanceof client_1.SwaggerException)throw new Error(`An error has occurred during '${operation}': ${error} ${error.status}, ${error.response}`);throw error}deleteDevice(deviceId){return __awaiter(this,void 0,void 0,function*(){try{yield this.api.deleteDevice(deviceId);const d=this._persistenceManager.devices().find(d=>d.id==deviceId);return void(d&&this._persistenceManager.remove(d))}catch(error){this.handleError(error,`delete device '${deviceId}'`)}})}createPublication(topic,range,duration,properties,deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId),publication=new client_1.Publication({worldId:this.token.sub,topic:topic,deviceId:deviceWithId,range:range,duration:duration,properties:properties}),result=yield this.api.createPublication(deviceWithId,publication);return this._persistenceManager.add(result),result}catch(error){this.handleError(error,`create publication for topic ${topic}`)}})}deletePublication(deviceId,pubId){return __awaiter(this,void 0,void 0,function*(){try{yield this.api.deletePublication(deviceId,pubId);const d=this._persistenceManager.publications().find(d=>d.id==pubId);d&&this._persistenceManager.remove(d)}catch(error){this.handleError(error,`delete publication for device ${deviceId}, publication ${pubId}`)}})}createSubscription(topic,range,duration,selector,deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId),subscription=new client_1.Subscription({worldId:this.token.sub,topic:topic,deviceId:deviceWithId,range:range,duration:duration,selector:selector||""}),result=yield this.api.createSubscription(deviceWithId,subscription);return this._persistenceManager.add(result),result}catch(error){this.handleError(error,`create subscription for topic ${topic}`)}})}deleteSubscription(deviceId,subId){return __awaiter(this,void 0,void 0,function*(){try{const result=yield this.api.deleteSubscription(deviceId,subId),d=this._persistenceManager.publications().find(d=>d.id==subId);return d&&this._persistenceManager.remove(d),result}catch(error){this.handleError(error,`delete subscription for device ${deviceId}, subscription ${subId}`)}})}updateLocation(location,deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId);yield this.api.createLocation(deviceWithId,this.resolveLocationType(location))}catch(error){this.handleError(error,`creating location ['${location.latitude}'`)}})}resolveLocationType(location){return this.isLocation(location)||this.badLocation(location),new client_1.Location({altitude:location.altitude||0,latitude:location.latitude,longitude:location.longitude})}badLocation(location){let str="";try{str=JSON.stringify(location)}catch(_a){}throw new Error(`Location ${str} was invalid`)}isLocation(obj){return void 0!==obj&&void 0!==obj.longitude&&void 0!==obj.latitude}getAllMatches(deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId);return yield this.api.getMatches(deviceWithId)}catch(error){this.handleError(error,"fetch matches")}})}getMatch(matchId,deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId);return yield this.api.getMatch(deviceWithId,matchId)}catch(error){this.handleError(error,`fetch match ${matchId}`)}})}getAllPublications(deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId);return yield this.api.getPublications(deviceWithId)}catch(error){this.handleError(error,"fetch publications")}})}deviceWithId(deviceId){if(deviceId)return deviceId;if(this.defaultDevice&&this.defaultDevice.id)return this.defaultDevice.id;throw new Error("There is no default device available and no other device id was supplied,  please call createDevice before thi call or provide a device id")}getAllSubscriptions(deviceId){return __awaiter(this,void 0,void 0,function*(){try{const deviceWithId=this.deviceWithId(deviceId);return yield this.api.getSubscriptions(deviceWithId)}catch(error){this.handleError(error,"fetch subscriptions")}})}set onMatch(completion){this._matchMonitor.onMatch=completion}set onLocationUpdate(completion){this._locationManager.onLocationUpdate=completion}startMonitoringMatches(mode){this._matchMonitor.startMonitoringMatches(mode)}stopMonitoringMatches(){this._matchMonitor.stopMonitoringMatches()}startUpdatingLocation(){this._locationManager.startUpdatingLocation()}stopUpdatingLocation(){this._locationManager.stopUpdatingLocation()}}},{"./client":1,"./index":2,"./locationmanager":3,"./matchmonitor":5,Base64:10}],5:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const WebSocket=require("universal-websocket-client");var MatchMonitorMode;!function(MatchMonitorMode){MatchMonitorMode[MatchMonitorMode.polling=0]="polling",MatchMonitorMode[MatchMonitorMode.websocket=1]="websocket"}(MatchMonitorMode=exports.MatchMonitorMode||(exports.MatchMonitorMode={}));exports.MatchMonitor=class{constructor(manager){this.manager=manager,this._deliveredMatches=[],this._onMatch=(match=>{})}set onMatch(onMatch){this._onMatch=onMatch}get deliveredMatches(){return this._deliveredMatches}startMonitoringMatches(mode){if(!this.manager.defaultDevice)throw new Error("Default device not yet set!");if(void 0!==mode&&mode!=MatchMonitorMode.polling){if(mode==MatchMonitorMode.websocket){const socketUrl=this.manager.apiUrl.replace("https://","wss://").replace("http://","ws://").replace("v5","")+"pusher/v5/ws/"+this.manager.defaultDevice.id;new WebSocket(socketUrl,["api-key",this.manager.token.sub]).onmessage=(msg=>__awaiter(this,void 0,void 0,function*(){return yield this.checkMatch(msg.data)}))}}else this.stopMonitoringMatches(),setInterval(()=>{this.checkMatches()},1e3)}stopMonitoringMatches(){this._timerId&&clearInterval(this._timerId)}checkMatch(matchId){return __awaiter(this,void 0,void 0,function*(){if("ping"!=matchId&&"pong"!=matchId&&this.manager.defaultDevice&&this.hasNotBeenDelivered({id:matchId}))try{const match=yield this.manager.getMatch(matchId,this.manager.defaultDevice.id);this._deliveredMatches.push(match),this._onMatch(match)}catch(error){console.log(error)}})}checkMatches(){this.manager.getAllMatches().then(matches=>{for(const idx in matches){const match=matches[idx];this.hasNotBeenDelivered(match)&&(this._deliveredMatches.push(match),this._onMatch(match))}})}hasNotBeenDelivered(match){for(const idx in this._deliveredMatches)if(this._deliveredMatches[idx].id==match.id)return!1;return!0}}},{"universal-websocket-client":11}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.MatchmoreEntityDiscriminator=class{static isDevice(x){return void 0!==x.deviceToken||void 0!==x.location||void 0!==x.proximityUUID}static isSubscription(x){return void 0!==x.selector}static isPublication(x){return void 0!==x.properties}}},{}],7:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const persistence_1=require("../persistence");exports.default=class{constructor(){this._devices=[],this._publications=[],this._subscriptions=[]}devices(){return this._devices}publications(){return this._publications}onLoad(onLoad){this._onLoad=onLoad}subscriptions(){return this._subscriptions}add(entity){if(persistence_1.MatchmoreEntityDiscriminator.isDevice(entity)){const device=entity;this._devices.push(device)}else if(persistence_1.MatchmoreEntityDiscriminator.isPublication(entity)){const pub=entity;this._publications.push(pub)}else if(persistence_1.MatchmoreEntityDiscriminator.isSubscription(entity)){const sub=entity;this._subscriptions.push(sub)}}remove(entity){if(persistence_1.MatchmoreEntityDiscriminator.isDevice(entity)){const device=entity;if(device.id==this._defaultDevice.id)throw new Error("Cannot deconste default device");this._devices=this._devices.filter(d=>device.id!=d.id)}else if(persistence_1.MatchmoreEntityDiscriminator.isPublication(entity)){const pub=entity;this._publications=this._publications.filter(d=>pub.id!=d.id)}else if(persistence_1.MatchmoreEntityDiscriminator.isSubscription(entity)){const sub=entity;this._subscriptions=this._subscriptions.filter(d=>sub.id!=d.id)}}defaultDevice(){return this._defaultDevice}addDevice(device,isDefault){this.add(device),isDefault&&(this._defaultDevice=device)}load(){return __awaiter(this,void 0,void 0,function*(){return!0})}save(){return __awaiter(this,void 0,void 0,function*(){return!0})}}},{"../persistence":6}],8:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const persistence_1=require("../persistence"),platform_1=require("../platform"),storageKey="@matchmoreSdk:data";exports.default=class{constructor(){this._devices=[],this._publications=[],this._subscriptions=[]}devices(){return this._devices}publications(){return this._publications}subscriptions(){return this._subscriptions}add(entity){if(persistence_1.MatchmoreEntityDiscriminator.isDevice(entity)){const device=entity;return this._devices.push(device),void this.save()}if(persistence_1.MatchmoreEntityDiscriminator.isPublication(entity)){const pub=entity;return this._publications.push(pub),void this.save()}if(persistence_1.MatchmoreEntityDiscriminator.isSubscription(entity)){const sub=entity;return this._subscriptions.push(sub),void this.save()}}remove(entity){if(persistence_1.MatchmoreEntityDiscriminator.isDevice(entity)){const device=entity;if(device.id==this._defaultDevice.id)throw new Error("Cannot deconste default device");return this._devices=this._devices.filter(d=>device.id!=d.id),void this.save()}if(persistence_1.MatchmoreEntityDiscriminator.isPublication(entity)){const pub=entity;return this._publications=this._publications.filter(d=>pub.id!=d.id),void this.save()}if(persistence_1.MatchmoreEntityDiscriminator.isSubscription(entity)){const sub=entity;return this._subscriptions=this._subscriptions.filter(d=>sub.id!=d.id),void this.save()}}defaultDevice(){return this._defaultDevice}addDevice(device,isDefault){this.add(device),isDefault&&(this._defaultDevice=device),this.save()}onLoad(onLoad){this._onLoad=onLoad}load(){return __awaiter(this,void 0,void 0,function*(){const dataString=yield platform_1.default.storage.load(storageKey),data=JSON.parse(dataString);return data&&(this._devices=data.devices.map(deviceObject=>deviceObject),this._subscriptions=data.subscriptions.map(subscriptionObject=>subscriptionObject),this._publications=data.publications.map(publicationObject=>publicationObject),this._defaultDevice=data.defaultDevice),!0})}save(){return __awaiter(this,void 0,void 0,function*(){const saveData={devices:this._devices,subscriptions:this._subscriptions,publications:this._publications,defaultDevice:this._defaultDevice};return yield platform_1.default.storage.save(storageKey,JSON.stringify(saveData))})}}},{"../persistence":6,"../platform":9}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class PlatformConfig{constructor(){this.storage=null,this.webSocket=null}static getInstance(){return PlatformConfig.instance||(PlatformConfig.instance=new PlatformConfig),PlatformConfig.instance}}exports.PlatformConfig=PlatformConfig;const instance=PlatformConfig.getInstance();exports.default=instance},{}],10:[function(require,module,exports){!function(){var object=void 0!==exports?exports:"undefined"!=typeof self?self:$.global,chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function InvalidCharacterError(message){this.message=message}InvalidCharacterError.prototype=new Error,InvalidCharacterError.prototype.name="InvalidCharacterError",object.btoa||(object.btoa=function(input){for(var block,charCode,str=String(input),idx=0,map=chars,output="";str.charAt(0|idx)||(map="=",idx%1);output+=map.charAt(63&block>>8-idx%1*8)){if((charCode=str.charCodeAt(idx+=.75))>255)throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");block=block<<8|charCode}return output}),object.atob||(object.atob=function(input){var str=String(input).replace(/[=]+$/,"");if(str.length%4==1)throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");for(var bs,buffer,bc=0,idx=0,output="";buffer=str.charAt(idx++);~buffer&&(bs=bc%4?64*bs+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0)buffer=chars.indexOf(buffer);return output})}()},{}],11:[function(require,module,exports){"use strict";module.exports=WebSocket},{}]},{},[2])(2)});
